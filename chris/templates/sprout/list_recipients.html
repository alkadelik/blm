{% extends 'base.html' %}

{% block head %}
<title>Home</title>
{% endblock %}

{% block body %}
<form method="post">
  {% csrf_token %}
  <section class="fence">
    <div id="title-block">
      <h2>Link a bank account to this budget</h2>
    </div>
    <div id="main">
      <div class="gap"></div>
      {% for bank in banks|slice:":4" %}
      <div class="q-block">
        <div class="budget">
          <input type="radio" name="bank" value="{{ bank.id }}">
            {{ bank.holder_name }} | {{ bank.acc_no }} | {{ bank.bank }}
            <span class="delete" onclick="delete()">&times;</span>
        </div>
      </div>
      {% endfor %}
      <div id="nav" class="q-block">
        <button type="button" onclick="link_recipient()"> Link Recipient </button>
      </div>
    </div>
  </section>
</form>
<a href="{% url "sprout:new_recipient" %}">
  <button type="button">Add New Account</button>
</a>

<script>
  function link_recipient(){
    var recipient = document.getElementsByName("bank");
    for (var i=0, length = recipient.length; i<length; i++)
    {
      if (recipient[i].checked)
      {
        $.ajax({
          type: "POST",
          url: "/sprout/link_recipient/",
          data: {
            "recipient_id": recipient[i].value,
            "csrfmiddlewaretoken": "{{csrf_token}}"
          },
          success: function(response){
            window.location.href = "/sprout/pay";
          },
        });
        break;
      }
    }
  }
  function delete(){
    
  }
</script>
{% endblock %}
